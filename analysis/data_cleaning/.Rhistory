users <- left_join(users, wpt1_user_level[,c(2,4)], by = "user_id")
wpt1_capabilities <- subset(usermeta, usermeta$meta_key == "wpt1_capabilities")
wpt1_capabilities$meta_value <- as.factor(wpt1_capabilities$meta_value)
summary(wpt1_capabilities$meta_value)
colnames(wpt1_capabilities)[4] <- "user_wpt1_capabilities"
# length(unique(wpt1_user_level$user_id))
users <- left_join(users, wpt1_capabilities[,c(2,4)], by = "user_id")
users$user_wpt1_capabilities <- str_extract(users$user_wpt1_capabilities, '"(.*?)"')
users$user_wpt1_capabilities <- substring(users$user_wpt1_capabilities, 2, nchar(users$user_wpt1_capabilities)-1)
View(users)
users$user_wpt1_capabilities <- substring(users$user_wpt1_capabilities, 2, users$user_wpt1_capabilities <- as.factor(users$user_wpt1_capabilities)
names(activity)
names(activity)
length(unique(activity$activity_id)) == length(activity$activity_id) # TRUE
activity[,c(4:5)] <- lapply(activity[,c(4:5)], factor)
summary(activity$activity_type)
# summary statistics
paste(nrow(activity), "activities in total for",length(unique(activity$course_id)),
"courses (", length(unique(activity$post_id)), "posts )",
"were conducted by",length(unique(activity$user_id)), "users. (without taking activity status into account)", sep = " ")
# summary statistics
paste(nrow(activity), "activities in total for",length(unique(activity$course_id)),
"courses (", length(unique(activity$post_id)), "posts )",
"were conducted by",length(unique(activity$user_id)), "users. (without taking activity status into account)", sep = " ")
View(activity)
set.seed(8888)
# Helper function to install a package if not installed and load.
use_package <- function(p){
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,
repos = c(CRAN = 'http://cran.us.r-project.org'))
library(p, character.only = TRUE, quietly = TRUE, verbose = FALSE)
}
use_package("RMySQL")
use_package("tidyverse")
use_package("ggplot2")
use_package("mosaic")
use_package("classInt")
use_package("tabplot")
use_package("data.table")
#use_package("stringr")
use_package("anytime")
use_package("GGally")
use_package("lme4")
use_package("boot")
use_package("finalfit")
knitr::opts_chunk$set(
fig.path = "README_figs/README-"
)
db <- dbConnect(RMySQL::MySQL(), host='localhost', port=3306, dbname = "rco_classroom",
user = "Hua", password = "24")
dbSendQuery(db,'SET NAMES utf8')
rdb = dbConnect(MySQL(), user = 'Hua', password = '24', dbname = 'rco_classroom', host = 'localhost', port = 3306)
{
users <- dbGetQuery(rdb, "SELECT * FROM wpt1_users")
usermeta <- dbGetQuery(rdb, "SELECT * FROM wpt1_usermeta")
activity <- dbGetQuery(rdb, "SELECT * FROM wpt1_learndash_user_activity")
activitymeta <- dbGetQuery(rdb, "SELECT * FROM wpt1_learndash_user_activity_meta")
posts <- dbGetQuery(rdb, "SELECT ID, post_title, post_type, post_content FROM wpt1_posts")
postmeta <- dbGetQuery(rdb, "SELECT * FROM wpt1_postmeta WHERE meta_key IN ('course_id', 'lesson_id', 'question_id' 'quiz_id', 'quiz_pro_id')")
quiz_question <- dbGetQuery(rdb, "SELECT * FROM wpt1_wp_pro_quiz_question")
quiz_statistic <- dbGetQuery(rdb, "SELECT * FROM wpt1_wp_pro_quiz_statistic")
quiz_statistic_ref <- dbGetQuery(rdb, "SELECT * FROM wpt1_wp_pro_quiz_statistic_ref")
quiz_toplist <- dbGetQuery(rdb, "SELECT * FROM wpt1_wp_pro_quiz_toplist") # why only for quiz 18 and quiz 169: quiz_id, date, user name, points,results
}
dbDisconnect(rdb)
names(users)
# check duplicated records: No duplicates when it returns TRUE
length(unique(users$ID)) == length(users$ID) #TRUE
# make column names of columns of interest consitent
setnames(users, old = c("ID", "user_registered"), new = c("user_id", "user_registered_at"))
# convert balnk cells to NA
users$user_url <- ifelse(nzchar(users$user_url), users$user_url, NA)
users$user_activation_key <- ifelse(nchar(users$user_activation_key) == 0,
NA,users$user_activation_key)
# get ratio of NAs
round(sum(is.na(users$user_url))/nrow(users), 3) # 79.1% of users' url are missing
round(sum(is.na(users$user_activation_key))/nrow(users), 3) # 94.2% of users' activation key are missing
# fix data type
users$user_registered_at <- as.Date(as.factor(users$user_registered_at), format = "%Y-%m-%d %H:%M:%S")
users <- users[,c(1,7)]
# summary statistics
paste("There are", nrow(users), "users registered in total at therefugeecenter.org from",
range(users$user_registered_at)[1], "to", range(users$user_registered_at)[2], ".", sep = " ")
users_date <- users %>%
group_by(user_registered_at) %>%
summarise(num_user = n()) %>%
mutate(total_user = cumsum(num_user))
users_date$user_registered_at <- as.Date(as.factor(users_date$user_registered_at), format = "%Y-%m-%d")
p1 <- ggplot(users_date, aes(x = user_registered_at, y = total_user)) +
geom_line() +
xlab("Date") +
ylab("Total Number of Users") +
ggtitle("Total Number of RCO Users Registered Since 2015") +
theme_bw()
p1
usermeta$meta_key <- as.factor(usermeta$meta_key)
t1 <- as.data.frame(summary(usermeta$meta_key))
t1 <- setDT(t1, keep.rownames = TRUE)
knitr::kable(head(t1))
wpt1_user_level <- subset(usermeta, usermeta$meta_key == "wpt1_user_level")
wpt1_user_level$meta_value <- as.factor(wpt1_user_level$meta_value)
summary(wpt1_user_level$meta_value)
colnames(wpt1_user_level)[4] <- "user_level"
# length(unique(wpt1_user_level$user_id))
users <- left_join(users, wpt1_user_level[,c(2,4)], by = "user_id")
wpt1_capabilities <- subset(usermeta, usermeta$meta_key == "wpt1_capabilities")
wpt1_capabilities$meta_value <- as.factor(wpt1_capabilities$meta_value)
summary(wpt1_capabilities$meta_value)
colnames(wpt1_capabilities)[4] <- "user_wpt1_capabilities"
# length(unique(wpt1_user_level$user_id))
users <- left_join(users, wpt1_capabilities[,c(2,4)], by = "user_id")
users$user_wpt1_capabilities <- stringr::str_extract(users$user_wpt1_capabilities, '"(.*?)"')
users$user_wpt1_capabilities <- substring(users$user_wpt1_capabilities,2,
nchar(users$user_wpt1_capabilities)-1)
users$user_wpt1_capabilities <- as.factor(users$user_wpt1_capabilities)
users_level <- users %>%
group_by(user_wpt1_capabilities) %>%
summarise(num_users = n())
p2 <- ggplot(data = users_level, aes(x = factor(1),
y = num_users,
fill = user_wpt1_capabilities)) +
coord_polar(theta = "y")
names(activity)
length(unique(activity$activity_id)) == length(activity$activity_id) # TRUE
activity[,c(4:5)] <- lapply(activity[,c(4:5)], factor)
activity$activity_started <- as.POSIXct(activity$activity_started, origin="1970-01-01")
activity$activity_completed <- as.POSIXct(activity$activity_completed, origin="1970-01-01")
activity$activity_updated <- anytime(activity$activity_updated)
summary(activity$activity_type)
# summary statistics
paste(nrow(activity), "activities in total for",length(unique(activity$course_id)),
"courses (", length(unique(activity$post_id)), "posts )",
"were conducted by",length(unique(activity$user_id)), "users. (without taking activity status into account)", sep = " ")
p2 <- ggplot(activity, aes(activity_type)) +
geom_bar(aes(fill = activity_status)) +
xlab("Activity Type") +
ylab("Number of Activities") +
ggtitle("Number of Activities by Activity Type & Activity Status") +
theme_bw()
p2
user_activity <- activity %>%
group_by(user_id) %>%
summarise(num_activities = n())
users$num_activities <- ifelse(users$user_id %in% user_activity$user_id, user_activity$num_activities, 0)
round(nrow(subset(users, !(users$user_id %in% user_activity$user_id)))/nrow(users), 3)
users$activity_level <- num2fac(users$num_activities)
users2 <- as.data.frame(users[,c(1,6)])
tableplot(users2)
names(activitymeta)
activitymeta$activity_meta_key <- as.factor(activitymeta$activity_meta_key)
summary(activitymeta$activity_meta_key)
activitymeta$activity_meta_value <- ifelse(nzchar(activitymeta$activity_meta_value), activitymeta$activity_meta_value, NA)
paste("There are", length(unique(activitymeta$activity_meta_key)), "meta keys for",
length(unique(activitymeta$activity_id)), "activities and", sum(is.na(activitymeta$activity_meta_value)), "of the meta values are missing (out of", (nrow(activitymeta)-sum(is.na(activitymeta$activity_meta_value))), "meta values in total).", sep = " ")
# how to write more efficient functions to add below columns to activity table (except mutate from dplyr)
course <- subset(activitymeta, activitymeta$activity_meta_key == "course")
length(unique(course$activity_id)) == nrow(course) # TRUE
activity$course_id <- ifelse(activity$activity_id %in% course$activity_id, course$activity_meta_value, NA)
topic <- subset(activitymeta, activitymeta$activity_meta_key == "topic")
length(unique(topic$activity_id)) == nrow(topic) # TRUE
activity$topic_id <- ifelse(activity$activity_id %in% topic$activity_id, topic$activity_meta_value, NA)
lesson <- subset(activitymeta, activitymeta$activity_meta_key == "lesson") # 121 lessons, have
lesson$activity_meta_value <- as.factor(lesson$activity_meta_value)
length(unique(lesson$activity_id)) == nrow(lesson) # TRUE
activity$lesson <- ifelse(activity$activity_id %in% lesson$activity_id, lesson$activity_meta_value, NA)
m_edit_by <- subset(activitymeta, activitymeta$activity_meta_key == "m_edit_by")
length(unique(m_edit_by$activity_id)) == nrow(m_edit_by) # TRUE
activity$m_edit_by <- ifelse(activity$activity_id %in% m_edit_by$activity_id, m_edit_by$activity_meta_value, NA)
m_edit_time <- subset(activitymeta, activitymeta$activity_meta_key == "m_edit_time")
length(unique(m_edit_time$activity_id)) == nrow(m_edit_time) # TRUE
activity$m_edit_time <- ifelse(activity$activity_id %in% m_edit_time$activity_id, m_edit_time$activity_meta_value, NA)
lesson_steps_completed <- subset(activitymeta, activitymeta$activity_meta_key == "steps_completed")
length(unique(lesson_steps_completed$activity_id)) == nrow(lesson_steps_completed) # TRUE
activity$lesson_steps_completed <- ifelse(activity$activity_id %in% lesson_steps_completed$activity_id, lesson_steps_completed$activity_meta_value, NA)
lesson_steps_total <- subset(activitymeta, activitymeta$activity_meta_key == "steps_total")
length(unique(lesson_steps_total$activity_id)) == nrow(lesson_steps_total) # TRUE
activity$lesson_steps_total <- ifelse(activity$activity_id %in% lesson_steps_total$activity_id, lesson_steps_total$activity_meta_value, NA)
quiz <- subset(activitymeta, activitymeta$activity_meta_key == "quiz")
length(unique(quiz$activity_id)) == nrow(quiz) # TRUE
activity$quiz_id_activity <- ifelse(activity$activity_id %in% quiz$activity_id, quiz$activity_meta_value, NA)
pro_quizid <- subset(activitymeta, activitymeta$activity_meta_key == "pro_quizid")
length(unique(pro_quizid$activity_id)) == nrow(pro_quizid) # TRUE
activity$pro_quizid <- ifelse(activity$activity_id %in% pro_quizid$activity_id, pro_quizid$activity_meta_value, NA)
statistic_ref_id <- subset(activitymeta, activitymeta$activity_meta_key == "statistic_ref_id")
length(unique(statistic_ref_id$activity_id)) == nrow(statistic_ref_id) # TRUE
activity$statistic_ref_id <- ifelse(activity$activity_id %in% statistic_ref_id$activity_id, statistic_ref_id$activity_meta_value, NA)
question_show_count <- subset(activitymeta, activitymeta$activity_meta_key == "question_show_count")
length(unique(question_show_count$activity_id)) == nrow(question_show_count) # TRUE
activity$question_show_count <- ifelse(activity$activity_id %in% question_show_count$activity_id, question_show_count$activity_meta_value, NA)
graded <- subset(activitymeta, activitymeta$activity_meta_key == "graded")
length(unique(graded$activity_id)) == nrow(graded) # TRUE
activity$graded <- ifelse(activity$activity_id %in% graded$activity_id, graded$activity_meta_value, NA)
has_graded <- subset(activitymeta, activitymeta$activity_meta_key == "has_graded")
length(unique(has_graded$activity_id)) == nrow(has_graded) # TRUE
activity$has_graded <- ifelse(activity$activity_id %in% has_graded$activity_id, has_graded$activity_meta_value, NA)
percentage <- subset(activitymeta, activitymeta$activity_meta_key == "percentage") # earned point out total_points
length(unique(percentage$activity_id)) == nrow(percentage) # TRUE
activity$percentage <- ifelse(activity$activity_id %in% percentage$activity_id, percentage$activity_meta_value, NA)
timespent <- subset(activitymeta, activitymeta$activity_meta_key == "timespent")
length(unique(timespent$activity_id)) == nrow(timespent) # TRUE
activity$timespent <- ifelse(activity$activity_id %in% timespent$activity_id, timespent$activity_meta_value, NA)
time <- subset(activitymeta, activitymeta$activity_meta_key == "time")
length(unique(time$activity_id)) == nrow(time) # TRUE
activity$time <- ifelse(activity$activity_id %in% time$activity_id, time$activity_meta_value, NA)
count <- subset(activitymeta, activitymeta$activity_meta_key == "count")
length(unique(count$activity_id)) == nrow(count) # TRUE
activity$count <- ifelse(activity$activity_id %in% count$activity_id, count$activity_meta_value, NA)
points <- subset(activitymeta, activitymeta$activity_meta_key == "points")
length(unique(points$activity_id)) == nrow(points) # TRUE
activity$points <- ifelse(activity$activity_id %in% points$activity_id, points$activity_meta_value, NA)
total_points <- subset(activitymeta, activitymeta$activity_meta_key == "total_points")
length(unique(total_points$activity_id)) == nrow(total_points) # TRUE
activity$total_points <- ifelse(activity$activity_id %in% total_points$activity_id, total_points$activity_meta_value, NA)
score <- subset(activitymeta, activitymeta$activity_meta_key == "score")
length(unique(score$activity_id)) == nrow(score) # TRUE
activity$score <- ifelse(activity$activity_id %in% score$activity_id, score$activity_meta_value, NA)
# completed time: unix time
completed <- subset(activitymeta, activitymeta$activity_meta_key == "completed")
length(unique(completed$activity_id)) == nrow(completed) # TRUE
activity$completed <- ifelse(activity$activity_id %in% completed$activity_id, completed$activity_meta_value, NA)
pass <- subset(activitymeta, activitymeta$activity_meta_key == "pass")
length(unique(pass$activity_id)) == nrow(pass) # TRUE
activity$pass <- ifelse(activity$activity_id %in% pass$activity_id, pass$activity_meta_value, NA)
rank <- subset(activitymeta, activitymeta$activity_meta_key == "rank")
length(unique(rank$activity_id)) == nrow(rank) # TRUE
activity$rank <- ifelse(activity$activity_id %in% rank$activity_id, rank$activity_meta_value, NA)
names(posts)
colnames(posts)[1] <- "post_id"
# sum(is.na(posts))
posts$post_content <- ifelse(nzchar(posts$post_content), posts$post_content, NA)
posts <- subset(posts, posts$post_type %in% c("sfwd-assignment", "sfwd-certificates",
"sfwd-courses", "sfwd-essays",
"sfwd-lessons","sfwd-quiz", "sfwd-topic",
"sfwd-zapier"))
length(unique(posts$post_title)) # 698 essay quiz questions in total
posts_quiz <- subset(posts, posts$post_type == "sfwd-quiz")
round(sum(is.na(posts_quiz$post_content))/nrow(posts_quiz), 3)
sfwd_courses <- subset(posts, posts$post_type == "sfwd-courses")
activity$course_title <- ifelse(activity$post_id %in% sfwd_courses$post_id, sfwd_courses$post_title, NA)
names(postmeta)
length(unique(postmeta$meta_id)) == nrow(postmeta) # TRUE
postmeta$meta_key <- as.factor(postmeta$meta_key)
summary(postmeta$meta_key)
coursemeta <- subset(postmeta, postmeta$meta_key == "course_id")
length(unique(coursemeta$post_id)) == nrow(coursemeta) # TRUE
course <- left_join(coursemeta[,c(1:2,4)], posts, by = "post_id")
colnames(course)[1] <- "postmeta_id"
colnames(course)[3] <- "course_id"
course <- course[,c(2,1,3,5,4,6)]
colnames(course)[5] <- "course_post_title"
colnames(course)[6] <- "course_post_content"
lessonmeta <- subset(postmeta, postmeta$meta_key == "lesson_id")
length(unique(lessonmeta$post_id)) == nrow(lessonmeta) # TRUE
lesson <- left_join(lessonmeta[,c(1:2,4)], posts, by = "post_id")
colnames(lesson)[1] <- "postmeta_id"
colnames(lesson)[3] <- "lesson_id"
lesson <- lesson[,c(2,1,3,5,4,6)]
colnames(lesson)[5] <- "lesson_post_title"
colnames(lesson)[6] <- "lesson_post_content"
quizprometa <- subset(postmeta, postmeta$meta_key == "quiz_pro_id")
length(unique(quizprometa$post_id)) == nrow(quizprometa) # TRUE
quiz_pro <- left_join(quizprometa[,c(1:2,4)], posts, by = "post_id")
colnames(quiz_pro)[1] <- "postmeta_id"
colnames(quiz_pro)[3] <- "quiz_pro_id"
quiz_pro <- quiz_pro[,c(2,1,3,5,4,6)]
colnames(quiz_pro)[5] <- "quiz_pro_post_title"
colnames(quiz_pro)[6] <- "quiz_pro_post_content"
activity$post_type <- ifelse(activity$post_id %in% posts$post_id, posts$post_type, NA)
activity$course_post_title <- ifelse(activity$post_id %in% course$post_id, course$course_post_title, NA)
activity$course_post_content <- ifelse(activity$post_id %in% course$post_id, course$course_post_content, NA)
activity$lesson_post_title <- ifelse(activity$post_id %in% lesson$post_id, lesson$lesson_post_title, NA)
activity$lesson_post_content <- ifelse(activity$post_id %in% lesson$post_id, lesson$lesson_post_content, NA)
activity$quiz_pro_post_title <- ifelse(activity$post_id %in% quiz_pro$post_id, quiz_pro$quiz_pro_post_title, NA)
activity$quiz_pro_post_content <- ifelse(activity$post_id %in% quiz_pro$post_id, quiz_pro$quiz_pro_post_content, NA)
names(quiz_question)
colnames(quiz_question)[c(1,5,6)] <-c("question_id", "question_title", "question_points")
quiz_question$answer_data <- as.factor(quiz_question$answer_data)
summary(quiz_question$answer_data)
quiz_question$answer_type <- factor(quiz_question$answer_type)
t1 <- as.data.frame(summary(quiz_question$answer_type))
t1 <- setDT(t1, keep.rownames = TRUE)
setnames(t1, old = c("rn", "summary(quiz_question$answer_type)"), new = c("answer_type", "num_of_questions"))
knitr::kable(t1)
names(quiz_statistic)
colnames(quiz_statistic)[6] <- "user_question_point"
colnames(quiz_statistic)[8] <- "user_answer_data"
paste(length(unique(quiz_statistic$question_id)), "quiz questions were answered.", sep = " ")
names(quiz_statistic_ref)
paste("Create time of",length(unique(quiz_statistic_ref$quiz_id)), "quizzes and gender (and hometown, having kids or not) information of",
length(unique(quiz_statistic_ref$user_id)), "users are recorded and none of the questions are old.", sep = " ")
names(quiz_toplist)
plot(quiz_toplist$points, quiz_toplist$result)
quiz_toplist$quiz_id <- as.factor(quiz_toplist$quiz_id)
summary(quiz_toplist$quiz_id)
quiz18_toplist <- subset(quiz_toplist, quiz_toplist$quiz_id == "18")
quiz18_question <-  subset(quiz_question, quiz_question$quiz_id == "18")
length(unique(quiz18_toplist$user_id)) == length(quiz18_toplist$user_id)
plot(quiz18_toplist$points, quiz18_toplist$result)
quiz169_toplist <- subset(quiz_toplist, quiz_toplist$quiz_id == "169")
quiz169_question <-  subset(quiz_question, quiz_question$quiz_id == "169")
length(unique(quiz169_toplist$user_id)) == length(quiz169_toplist$user_id) # TRUE
plot(quiz169_toplist$points, quiz169_toplist$result)
course_completed_10625 <- subset(usermeta, usermeta$meta_key == "course_completed_10625")
course_completed_10625$meta_value <- as.factor(course_completed_10625$meta_value)
summary(course_completed_10625$meta_value)
length(unique(course_completed_10625$user_id)) # 22 users completed course 10625
users_info <- users
users_quiz_statistic <- left_join(quiz_statistic[,c(1:2,5:8)], quiz_statistic_ref[,c(-5)], by = "statistic_ref_id")
colnames(quiz_question)[1] <- "question_id"
users_quiz <- left_join(users_quiz_statistic, quiz_question[,-c(2,3,8:10,14:15,17:20)], by = "question_id")
users_learning <- left_join(activity, users_info, by = "user_id")
users_learning$time <- as.integer(users_learning$time)
users_learning$completed <- as.integer(users_learning$completed)
users_learning$time <- as.POSIXct(users_learning$time, origin = "1970-01-01")
users_learning$completed <- as.POSIXct(users_learning$completed, origin = "1970-01-01")
sub <- subset(users, users$user_wpt1_capabilities == "subscriber")
sub_learning <- subset(users_learning, users_learning$user_wpt1_capabilities == "subscriber")
sub_quiz <- subset(users_quiz, users_quiz$user_id %in% sub$user_id)
sub_learning_quiz <- filter(sub_learning, activity_type == "quiz")
sub_quiz$statistic_ref_id <- as.character(sub_quiz$statistic_ref_id)
sub_Quiz <- left_join(sub_quiz, sub_learning_quiz, by = "statistic_ref_id")
sub_Learning <- subset(sub_learning, sub_learning$activity_type %in% c("course", "lesson"))
sub_Learning$course_title <- as.factor(sub_Learning$course_title)
sub_Learning_course <- subset(sub_Learning, sub_Learning$course_title %in% c("Citizenship Practice Test", "Citizenship Preparation Program","GED\xae Math Practice Test","GED\xae Practice Test", "GED\xae/HiSET&#x2122;: Basic Math", "GED\xae/HiSet&#x2122;: Language Arts", " GED\xae/HiSet&#x2122;: Science", " GED\xae/HiSet&#x2122;: Social Studies"))
write.csv(sub_Quiz, "~/Documents/Projects/rco_classroom/data/20180517/sub_Quiz.csv")
write.csv(sub_Learning, "~/Documents/Projects/rco_classroom/data/20180517/sub_Learning.csv")
set.seed(8888)
# Helper function to install a package if not installed and load.
use_package <- function(p){
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,
repos = c(CRAN = 'http://cran.us.r-project.org'))
library(p, character.only = TRUE, quietly = TRUE, verbose = FALSE)
}
use_package("RMySQL")
use_package("tidyverse")
use_package("ggplot2")
use_package("mosaic")
use_package("classInt")
use_package("tabplot")
use_package("data.table")
use_package("knitr")
use_package("stringr")
use_package("anytime")
use_package("GGally")
use_package("lme4")
use_package("boot")
use_package("finalfit")
use_package("gridExtra")
use_package("reshape2")
use_package("grid")
use_package("groupdata2")
knitr::opts_chunk$set(
fig.path = "README_figs/README-"
)
# for each user score: lesson_steps_completed, timespent, answer_type, hint_count, lesson, course_id, (m_edit_by )
sub_Quiz$course_id <- as.factor(sub_Quiz$course_id)
sub_Quiz$answer_type <- as.factor(sub_Quiz$answer_type)
sub_Quiz$m_edit_by <- as.factor(sub_Quiz$m_edit_by)
sub_Quiz$hint_count <- as.factor(sub_Quiz$hint_count)
sub_Quiz$tip_enabled <- as.factor(sub_Quiz$tip_enabled)
test_df <- sub_Quiz[,c(1,39,44,32,36,3, 15,
40,17,27)]
# remove NAs
test_df <- filter(test_df, is.na(percentage) == FALSE)
len_uni <- function(x){
# function for finding length of unique value x
length(unique(x))
}
test_df[,c(2:5,8)] <- lapply(test_df[,c(2:5,8)], as.numeric)
summary(test_df)
tableplot(test_df)
tableplot(test_df[,-1])
p4 <- ggplot(test_df, aes(percentage)) +
geom_histogram() +
theme_bw() +
xlab("Pounts Earned out of Total Points for Each Quiz") +
ylab("Number of Quizzes Taken by Online Students") +
ggtitle("Student Quiz Performance Overview")
p4
p5 <- ggplot(test_df, aes(course_id, y = percentage, fill = course_id)) +
geom_boxplot() +
xlab("Course ID") +
ylab("Quiz Points Percentage") +
ggtitle("Quiz Points Percentage by Course") +
theme_bw()
p5
p6 <- ggplot(test_df, aes(x =course_id)) +
geom_bar(aes(fill = answer_type)) +
xlab("Course ID") +
ylab("Number of Activities Recorded") +
theme_bw()
p6
m1 <- glmer(percentage ~ total_points + answer_type + lesson_steps_completed +
question_show_count + timespent + tip_enabled + course_id + (1|statistic_ref_id),
data = test_df)
crossvalidate <- function(data, k, model, dependent, random = FALSE){
# data is the training set with the ".folds" column
# k is the number of folds we have
# model is a string describing a linear regression model formula
# dependent is a string with the name of the score column we want to predict
# random is a logical; do we have random effects in the model?
# Initialize empty list for recording performances
performances <- c()
# One iteration per fold
for (fold in 1:k){
# Create training set for this iteration
# Subset all the datapoints where .folds does not match the current fold
training_set <- data[data$.folds != fold,]
# Create test set for this iteration
# Subset all the datapoints where .folds matches the current fold
testing_set <- data[data$.folds == fold,]
## Train model
# If there is a random effect,
# use lmer() to train model
# else use lm()
if (isTRUE(random)){
# Train linear mixed effects model on training set
model <-  lmer(model, training_set, REML=FALSE)
} else {
# Train linear model on training set
model <-  lm(model, training_set)
}
## Test model
# Predict the dependent variable in the testing_set with the trained model
predicted <- predict(model, testing_set, allow.new.levels=TRUE)
# Get the Root Mean Square Error between the predicted and the observed
RMSE <- rmse(predicted, testing_set[[dependent]])
# Add the RMSE to the performance list
performances[fold] <- RMSE
}
# Return the mean of the recorded RMSEs
return(c('RMSE' = mean(performances)))
}
m1 <- glmer(percentage ~ total_points + answer_type + lesson_steps_completed +
question_show_count + timespent + tip_enabled + course_id + (1|statistic_ref_id),
data = test_df)
m1 <- glm(percentage ~ total_points + answer_type + lesson_steps_completed +
question_show_count + timespent + tip_enabled + course_id + (1|statistic_ref_id),
data = test_df, family = gaussian)
m1 <- glmer(percentage ~ total_points + answer_type + lesson_steps_completed +
question_show_count + timespent + tip_enabled + course_id + (1|statistic_ref_id),
data = test_df, family = gaussian)
summary(m1)
plot(m1)
print(m1, corr = FALSE)
lattice::dotplot(ranef(m1, which = "DID", condVar = TRUE), scales = list(y = list(alternating = 0)))
use_package("qqPLOT")
use_package("qplot"")
use_package("qplot")
qqPlot(residuals(m1))
use_package("car")
qqPlot(residuals(m1))
plot(allEffects(m1))
use_package("effects")
plot(allEffects(m1))
vif(m1)
summary(m1$sigma)
p1
p5
p6
m1 <- glmer(percentage ~ total_points + answer_type + lesson_steps_completed +
question_show_count + timespent + tip_enabled + course_id + (1|statistic_ref_id),
data = test_df, family = gaussian)
qqPlot(residuals(m1))
qqPlot(residuals(m1))
tableplot(test_df[,-1])
tableplot(test_df)
names(sub_Quiz)
names(sub_Learning)
names(sub_learning_quiz)
names(sub_Quiz)
test_df <- sub_Quiz[,c(8,39,44,32,36,3, 15,
40,17,27)]
num_missing <- function(table_name){
# function for printing number of missing values of each column in the table (input)
for(name in colnames(table_name)){
print(paste(name, ":", sum(is.na(table_name[,name])),
"(",round(sum(is.na(table_name[,name]))/length(table_name[,name]),3),")"))
}
}
num_missing(test_df)
colnames(test_df)[1] <- "user_id"
num_missing(test_df)
# remove NAs
test_df <- filter(test_df, is.na(percentage) == FALSE)
len_uni <- function(x){
# function for finding length of unique value x
length(unique(x))
}
test_df[,c(2:5,8)] <- lapply(test_df[,c(2:5,8)], as.numeric)
summary(test_df)
tableplot(test_df[,-1])
tableplot(test_df)
test_df$user_id <- as.factor(test_df$user_id)
tableplot(test_df)
m1 <- glmer(percentage ~ total_points + answer_type + lesson_steps_completed +
question_show_count + timespent + tip_enabled + course_id + (1|user_id),
data = test_df, family = gaussian) # need to check error
print(m1, corr = FALSE)
plot(allEffects(m1))
qqPlot(residuals(m1))
lattice::dotplot(ranef(m1, which = "DID", condVar = TRUE), scales = list(y = list(alternating = 0)))
qqPlot(residuals(m1))
qqPlot(residuals(m1))
plot(m1)
plot(m1)
plot(m1)
tableplot(users2)
p6+ggtitle("Number of Quiz Answered by Question Type and Course")
675/30*20+200
